<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kars.timpeul.mappers.ArticleMapper">
    <insert id="insertList"
    useGeneratedKeys="true"
    keyColumn="index"
    keyProperty="index">
        INSERT INTO `5.19_test`.`q_list` (title_text, info_text, made_token, is_admin_only, created_at, modified_at, is_deleted)
        VALUES (#{lists.title}, #{lists.info}, #{lists.token}, #{lists.isAdmin}, #{lists.createdAt}, #{lists.modifiedAt}, #{lists.isDeleted})
    </insert>
    <insert id="insertQuestion">
        INSERT INTO `5.19_test`.questions (list_index, item_index, question, answers)
        VALUES (#{questions.listIndex}, #{questions.itemIndex}, #{questions.question}, #{questions.answer})
    </insert>

    <!-- 추가  -->
    <select id="selectListByIndex" resultType="com.kars.timpeul.entities.ArticleListEntity">
        SELECT `index`         AS `index`,
               `title_text`    AS `title`,
               `info_text`     AS `info`,
               `made_token`    AS `token`,
               `is_admin_only` AS `isAdmin`,
               `created_at`    AS `createdAt`,
               `modified_at`   AS `modifiedAt`,
               `is_deleted`    AS `isDelete`
        FROM `5.19_test`.`q_list`
        WHERE `index` = #{index}
    </select>
    <select id="selectQuestionByIndex" resultType="com.kars.timpeul.entities.ArticleQuestionEntity">
        SELECT `list_index` AS `listIndex`,
               `item_index` AS `itemIndex`,
               `question`   AS `question`,
               `answers`    AS `answers`
        FROM `5.19_test`.`questions`
        WHERE `list_index` = #{listIndex}
    </select>

    <!-- 모든 조회  O -->
    <select id="selectAll" resultType="com.kars.timpeul.entities.ArticleListEntity">
        SELECT `index`         AS `index`,
               `title_text`    AS `title`,
               `info_text`     AS `info`,
               `made_token`    AS `token`,
               `is_admin_only` AS `isAdmin`,
               `created_at`    AS `createdAt`,
               `modified_at`   AS `modifiedAt`,
               `is_deleted`    AS `isDelete`
        FROM `5.19_test`.`q_list`
        ORDER BY `index` DESC
    </select>


    <!-- 삭제 -->
    <update id="update">
        UPDATE `5.19_test`.`q_list`
        SET `index`         = #{list.index},
            `title_text`    = #{list.title},
            `info_text`     = #{list.info},
            `made_token`    = #{list.token},
            `is_admin_only` = #{list.isAdmin},
            `created_at`    = #{list.createdAt},
            `modified_at`   = #{list.modifiedAt},
            `is_deleted`    = #{list.isDeleted}
        WHERE `index` = #{list.index}
        LIMIT 1
    </update>
</mapper>